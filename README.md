# Домашнее задание №1 - Часть 2: Streamlit приложение

**Автор:** Соловьев Сергей Сергеевич

## Описание проекта

Интерактивное веб-приложение для предсказания стоимости автомобилей на основе обученной модели машинного обучения (ElasticNet). Приложение реализует все требования задания: отображение EDA графиков, ввод данных (CSV и ручной), применение модели и визуализацию весов.

## Выполненные требования

### ✅ Часть 5: Создание интерактивного приложения на Streamlit (3 балла)

1. **Отображение ключевых графиков EDA (1 балл)**
   - Гистограмма распределения цен (selling_price)
   - Интерактивные гистограммы для числовых признаков
   - Матрица корреляций с обработкой строковых значений
   - Scatter plots зависимости цены от признаков
   - Box plots для категориальных признаков

2. **Ввод данных и применение модели (1 балл)**
   - Загрузка CSV-файла с признаками объектов
   - Ручной ввод признаков через форму (6 полей)
   - Автоматическая предобработка данных (извлечение чисел из строк)
   - Применение обученной модели ElasticNet
   - Отображение предсказанных цен и метрик качества

3. **Визуализация весов модели (1 балл)**
   - Таблица коэффициентов модели
   - Bar chart коэффициентов
   - Горизонтальный bar chart важности признаков
   - Интерпретация наиболее важных признаков

## Структура проекта

```
ML_HW_1_part 2/
├── app.py                    # Streamlit приложение
├── requirements.txt          # Зависимости Python
├── model.pickle              # Обученная модель (scaler + model + feature_names)
├── cars_train.csv            # Данные для EDA
├── README.md                 # Документация
└── .gitignore                # Git ignore файл
```

## Функциональность приложения

### Вкладка "EDA"
- **Распределение целевой переменной:** гистограмма цен автомобилей
- **Распределение числовых признаков:** интерактивный выбор признака для анализа
- **Матрица корреляций:** визуализация связей между признаками
- **Зависимость цены от признаков:** scatter plots для анализа зависимостей
- **Категориальные признаки:** box plots распределения цен по категориям

### Вкладка "Предсказание"
- **Загрузка CSV файла:**
  - Автоматическая обработка строковых значений (mileage, engine, max_power)
  - Предсказание для всех строк в файле
  - Отображение метрик (количество, средняя цена, диапазон)
  - Визуализация распределения предсказаний
  - Таблица с результатами
  
- **Ручной ввод:**
  - Форма с 6 полями: год, пробег, расход топлива, объем двигателя, мощность, количество мест
  - Мгновенное получение предсказания цены
  - Визуализация результата

### Вкладка "Веса модели"
- Таблица всех коэффициентов модели
- График коэффициентов (положительные/отрицательные)
- График важности признаков (абсолютные значения)
- Метрики: общее количество признаков, положительные/отрицательные коэффициенты

## Технические детали

### Модель
- **Тип:** ElasticNet
- **Параметры:** alpha=1.0, l1_ratio=0.8
- **Признаки:** year, km_driven, mileage, engine, max_power, seats
- **Метрики качества:**
  - R² test = 0.5511
  - Бизнес-метрика (доля прогнозов с ошибкой ≤ 10%) = 24.90%

### Особенности реализации
- Автоматическая предобработка данных при загрузке CSV (извлечение чисел из строк)
- Кэширование модели и данных для оптимизации производительности
- Обработка ошибок с информативными сообщениями
- Минималистичный дизайн интерфейса

## Установка и запуск

### Локальный запуск

1. **Установка зависимостей:**
```bash
pip install -r requirements.txt
```

2. **Запуск приложения:**
```bash
streamlit run app.py
```

Приложение откроется в браузере по адресу `http://localhost:8501`

### Деплой на Streamlit Cloud

1. Репозиторий уже загружен в GitHub: https://github.com/SergeySolovyev/ML_HW_1_part2
2. Перейдите на [share.streamlit.io](https://share.streamlit.io/)
3. Войдите через GitHub
4. Нажмите "New app"
5. Выберите репозиторий `SergeySolovyev/ML_HW_1_part2`
6. Укажите:
   - **Main file path:** `app.py`
   - **Python version:** 3.11 (рекомендуется)
7. Нажмите "Deploy"

## Требования

- Python 3.11+
- Streamlit >= 1.28.0
- pandas >= 2.0.3
- numpy >= 1.24.0
- scikit-learn >= 1.3.0
- plotly >= 5.17.0

## Ссылка на приложение

Приложение задеплоено на Streamlit Cloud:

**https://mlhw1part2-7tmsvqobrbnumspebxugaa.streamlit.app/**

## GitHub репозиторий

Репозиторий с кодом: https://github.com/SergeySolovyev/ML_HW_1_part2

---

**Примечание:** Все файлы, необходимые для работы приложения, включены в репозиторий. Модель обучена и сохранена в `model.pickle`, данные для EDA находятся в `cars_train.csv`.
